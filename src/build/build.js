/*
 * The purpose of this build script is to package the browser-ready script
 * generated by Webpack into a userscript-ready file template,
 * which contains additional wiring.
 */
'use strict';

const fs = require('fs');

const packageInfo = require('../../package.json');

const template = fs.readFileSync(__dirname + '/userscript_template.js').toString();
const distScript = fs.readFileSync(__dirname + '/../../dist/bundle.js').toString();

const userscript = template
  .replace('{{name}}', packageInfo.name)
  .replace('{{description}}', packageInfo.description)
  .replace('{{license}}', packageInfo.license)
  .replace('{{author}}', packageInfo.author)
  .replace('{{version}}', packageInfo.version)
  .replace('{{script}}', distScript);

fs.writeFileSync(__dirname + '/../../netflix-activity-extract.user.js', userscript);
